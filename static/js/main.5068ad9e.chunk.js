(this["webpackJsonpsheet-dashboard"]=this["webpackJsonpsheet-dashboard"]||[]).push([[0],{120:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ActionMenu}));var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(42),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(41),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(14),_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(135),_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_7__),_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(136),_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_8__),react_icons_fi__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(124),paho_mqtt__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(31),paho_mqtt__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(paho_mqtt__WEBPACK_IMPORTED_MODULE_10__),crypto_js_aes__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(65),crypto_js_aes__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(crypto_js_aes__WEBPACK_IMPORTED_MODULE_11__),crypto_js_sha256__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(121),crypto_js_sha256__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(crypto_js_sha256__WEBPACK_IMPORTED_MODULE_12__),crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(122),crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_13__),crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_14__),ActionMenu=function(_React$Component){Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.a)(ActionMenu,_React$Component);var _super=Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.a)(ActionMenu);function ActionMenu(_){var e;return Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,ActionMenu),(e=_super.call(this,_)).broker="wss://broker.emqx.io:8084/mqtt",e.clientId="client-"+Math.random().toFixed(5),e}return Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(ActionMenu,[{key:"createKey",value:function(){var _=crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_13___default.a.random(16);return crypto_js_sha256__WEBPACK_IMPORTED_MODULE_12___default()(_).toString().slice(0,9)}},{key:"handleHeaderClick",value:function(){this.props.editMode?this.props.setEditMode(!1):this.props.setEditMode(!0)}},{key:"handleUploadClick",value:function(){var _=this.createKey(),e=_+"-channel";console.log(e);var t=JSON.stringify(this.props.getData()),a=crypto_js_aes__WEBPACK_IMPORTED_MODULE_11___default.a.encrypt(t,_),n=new paho_mqtt__WEBPACK_IMPORTED_MODULE_10__.Message(a.toString());n.destinationName=e,n.retained=!0;var r=new paho_mqtt__WEBPACK_IMPORTED_MODULE_10__.Client(this.broker,this.clientId);r.connect({onSuccess:function(e){r.send(n);var t=_.substr(0,3)+"-"+_.substr(3,3)+"-"+_.substr(6,3);alert("Uploaded workbook. The key is ".concat(t)),r.disconnect()}})}},{key:"handleDownloadClick",value:function(){var _=this,e=prompt("Please enter the 9 character key:").replaceAll("-",""),t=e+"-channel",a=new paho_mqtt__WEBPACK_IMPORTED_MODULE_10__.Client(this.broker,this.clientId);a.onMessageArrived=function(n){try{var r=crypto_js_aes__WEBPACK_IMPORTED_MODULE_11___default.a.decrypt(n.payloadString,e),o=JSON.parse(r.toString(crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_14___default.a)),s=new paho_mqtt__WEBPACK_IMPORTED_MODULE_10__.Message("");s.destinationName=t,s.retained=!0,a.send(s),_.props.saveData(o,!0)}catch(c){alert("Invalid key provided, please try again.")}a.disconnect()},a.connect({onSuccess:function(_){console.log("connected"),a.subscribe(t),setTimeout((function(){alert("No data is available for download, try uploading again."),a.disconnect()}),5e3)}})}},{key:"handlRefreshClick",value:function handlRefreshClick(){eval("luckysheet.refreshFormula()")}},{key:"handleDeleteClick",value:function(){localStorage.clear(),this.props.saveData(null,!0)}},{key:"render",value:function(){var _=this,e=this.props.editMode?"Live Mode":"Edit Mode";return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.a,{menuButton:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.b,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_icons_fi__WEBPACK_IMPORTED_MODULE_9__.a,{})}),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.d,{onClick:function(){_.handleHeaderClick()},children:e}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.c,{}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.d,{onClick:function(){_.handleUploadClick()},children:"Upload"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.d,{onClick:function(){_.handleDownloadClick()},children:"Download"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.d,{onClick:function(){_.handlRefreshClick()},children:"Refresh"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.c,{}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_6__.d,{styles:{color:"red"},onClick:function(){_.handleDeleteClick()},children:"Delete data"})]})}}]),ActionMenu}(react__WEBPACK_IMPORTED_MODULE_5___default.a.Component)},130:function(_,e,t){},131:function(_,e,t){},132:function(_,e,t){},136:function(_,e,t){},141:function(_,e){},143:function(_,e){},153:function(_,e){},155:function(_,e){},182:function(_,e){},183:function(_,e){},188:function(_,e){},190:function(_,e){},197:function(_,e){},216:function(_,e){},237:function(_,e,t){"use strict";t.r(e);var a=t(4),n=t(0),r=t.n(n),o=t(37),s=t.n(o),c=(t(130),t(9)),i=(t(131),t(39)),u=t(40),l=t(42),d=t(41),E=(t(132),function(_){Object(l.a)(t,_);var e=Object(d.a)(t);function t(){var _;Object(i.a)(this,t);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(_=e.call.apply(e,[this].concat(n))).state={editMode:_.props.editMode},_}return Object(u.a)(t,[{key:"getColumnsWidth",value:function(_){for(var e=window.innerWidth,t=_.getSheetData()[0].length,a=Math.floor(e/t),n={},r=0;r<t;r++)n[r]=a;return n}},{key:"resizeColumnsToScreenWidth",value:function(_){var e=this.getColumnsWidth(_);_.setColumnWidth(e),document.getElementsByClassName("luckysheet-scrollbar-x")[0].children[0].style.width=window.innerWidth.toString()+"px"}},{key:"buildLuckysheet",value:function(){var _=this,e={},t=this.props.data,a=t[0].visibledatarow.length,n=t[0].visibledatacolumn.length;(e=this.props.editMode?{data:this.props.data,container:"luckysheet",enableAddRow:!1,enableAddBackTop:!1,showinfobar:!1,showstatisticBar:!1,showsheetbarConfig:{menu:!1},row:a,column:n}:{data:t,container:"luckysheet",enableAddRow:!1,enableAddBackTop:!1,showtoolbar:!1,showinfobar:!1,sheetFormulaBar:!1,showstatisticBar:!1,allowCopy:!1,showsheetbarConfig:{menu:!1},row:a,column:n,columnHeaderHeight:0,rowHeaderWidth:0}).hook={workbookCreateAfter:function(e){_.resizeColumnsToScreenWidth(r),_.props.editMode?r.showGridLines():r.hideGridLines()},updated:function(){_.props.saveData(r.getAllSheets())}};var r=window.luckysheet;r.create(e)}},{key:"componentDidUpdate",value:function(){this.buildLuckysheet()}},{key:"componentDidMount",value:function(){this.buildLuckysheet()}},{key:"render",value:function(){var _=this.props.editMode?"editMode":"liveMode";return Object(a.jsx)("div",{id:"luckysheet",className:_,style:{margin:"0px",padding:"0px",position:"absolute",width:"100%",bottom:"0px",left:"0px",top:"0px"}})}}]),t}(r.a.Component)),p=t(120),h=[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0,visibledatarow:[[],[],[]],visibledatacolumn:[[],[],[]]}];var O=function(){var _=Object(n.useState)(l()),e=Object(c.a)(_,2),t=e[0],r=e[1],o=Object(n.useState)(!1),s=Object(c.a)(o,2),i=s[0],u=s[1];function l(){var _=localStorage.getItem("luckysheet-data");if(_)try{return JSON.parse(_)}catch(e){console.error("Error parsing localStorage data",e)}return h}function d(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==_&&(_=h);var t=JSON.stringify(_);localStorage.setItem("luckysheet-data",t),e&&r(l())}return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(E,{data:t,editMode:i,saveData:d}),Object(a.jsx)(p.a,{editMode:i,setEditMode:function(_){r(l()),u(_)},saveData:d,getData:l})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(a.jsx)(O,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(_){_.unregister()})).catch((function(_){console.error(_.message)}))}},[[237,1,2]]]);
//# sourceMappingURL=main.5068ad9e.chunk.js.map