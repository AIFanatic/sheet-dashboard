(this["webpackJsonpluckysheet-react"]=this["webpackJsonpluckysheet-react"]||[]).push([[0],{119:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ActionMenu}));var _home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(38),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(41),_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(40),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__),_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(13),_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(134),_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_szhsin_react_menu_dist_index_css__WEBPACK_IMPORTED_MODULE_6__),_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(135),_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_styles_actionmenu_css__WEBPACK_IMPORTED_MODULE_7__),react_icons_fi__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(123),paho_mqtt__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(30),paho_mqtt__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(paho_mqtt__WEBPACK_IMPORTED_MODULE_9__),crypto_js_aes__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(64),crypto_js_aes__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(crypto_js_aes__WEBPACK_IMPORTED_MODULE_10__),crypto_js_sha256__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(120),crypto_js_sha256__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(crypto_js_sha256__WEBPACK_IMPORTED_MODULE_11__),crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(121),crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_12__),crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(122),crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_13__),ActionMenu=function(_React$Component){Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__.a)(ActionMenu,_React$Component);var _super=Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_3__.a)(ActionMenu);function ActionMenu(_){var e;return Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,ActionMenu),(e=_super.call(this,_)).broker="ws://broker.mqttdashboard.com:8000/mqtt",e.clientId="client-"+Math.random().toFixed(5),e}return Object(_home_ubuntu_Downloads_temp_luckysheet_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(ActionMenu,[{key:"createKey",value:function(){var _=crypto_js_lib_typedarrays__WEBPACK_IMPORTED_MODULE_12___default.a.random(16);return crypto_js_sha256__WEBPACK_IMPORTED_MODULE_11___default()(_).toString().slice(0,9)}},{key:"handleHeaderClick",value:function(){this.props.editMode?this.props.setEditMode(!1):this.props.setEditMode(!0)}},{key:"handleUploadClick",value:function(){var _=this.createKey(),e=_+"-channel";console.log(e);var t=JSON.stringify(this.props.getData()),a=crypto_js_aes__WEBPACK_IMPORTED_MODULE_10___default.a.encrypt(t,_),n=new paho_mqtt__WEBPACK_IMPORTED_MODULE_9__.Message(a.toString());n.destinationName=e,n.retained=!0;var o=new paho_mqtt__WEBPACK_IMPORTED_MODULE_9__.Client(this.broker,this.clientId);o.connect({onSuccess:function(e){o.send(n);var t=_.substr(0,3)+"-"+_.substr(3,3)+"-"+_.substr(6,3);alert("Uploaded workbook. The key is ".concat(t)),o.disconnect()}})}},{key:"handleDownloadClick",value:function(){var _=this,e=prompt("Please enter the 9 character key:").replaceAll("-",""),t=e+"-channel",a=new paho_mqtt__WEBPACK_IMPORTED_MODULE_9__.Client(this.broker,this.clientId);a.onMessageArrived=function(n){try{var o=crypto_js_aes__WEBPACK_IMPORTED_MODULE_10___default.a.decrypt(n.payloadString,e),r=JSON.parse(o.toString(crypto_js_enc_utf8__WEBPACK_IMPORTED_MODULE_13___default.a)),c=new paho_mqtt__WEBPACK_IMPORTED_MODULE_9__.Message("");c.destinationName=t,c.retained=!0,a.send(c),_.props.saveData(r,!0)}catch(s){alert("Invalid key provided, please try again.")}a.disconnect()},a.connect({onSuccess:function(_){console.log("connected"),a.subscribe(t),setTimeout((function(){alert("No data is available for download, try uploading again."),a.disconnect()}),5e3)}})}},{key:"handlRefreshClick",value:function handlRefreshClick(){eval("luckysheet.refreshFormula()")}},{key:"handleDeleteClick",value:function(){localStorage.clear(),this.props.saveData(null,!0)}},{key:"render",value:function(){var _=this,e=this.props.editMode?"Live Mode":"Edit Mode";return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.a,{menuButton:react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.b,null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_icons_fi__WEBPACK_IMPORTED_MODULE_8__.a,null))},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.d,{onClick:function(){_.handleHeaderClick()}},e),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.c,null),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.d,{onClick:function(){_.handleUploadClick()}},"Upload"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.d,{onClick:function(){_.handleDownloadClick()}},"Download"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.d,{onClick:function(){_.handlRefreshClick()}},"Refresh"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.c,null),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_szhsin_react_menu__WEBPACK_IMPORTED_MODULE_5__.d,{styles:{color:"red"},onClick:function(){_.handleDeleteClick()}},"Delete data"))}}]),ActionMenu}(react__WEBPACK_IMPORTED_MODULE_4___default.a.Component)},124:function(_,e,t){_.exports=t(236)},129:function(_,e,t){},130:function(_,e,t){},131:function(_,e,t){},135:function(_,e,t){},140:function(_,e){},142:function(_,e){},152:function(_,e){},154:function(_,e){},181:function(_,e){},182:function(_,e){},187:function(_,e){},189:function(_,e){},196:function(_,e){},215:function(_,e){},236:function(_,e,t){"use strict";t.r(e);var a=t(0),n=t.n(a),o=t(36),r=t.n(o),c=(t(129),t(8)),s=(t(130),t(38)),i=t(39),l=t(41),u=t(40);t(131);var d=function(_){Object(l.a)(t,_);var e=Object(u.a)(t);function t(){var _;Object(s.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(_=e.call.apply(e,[this].concat(n))).state={editMode:_.props.editMode},_}return Object(i.a)(t,[{key:"getColumnsWidth",value:function(_){for(var e=window.innerWidth,t=_.getSheetData()[0].length,a=Math.floor(e/t),n={},o=0;o<t;o++)n[o]=a;return n}},{key:"resizeColumnsToScreenWidth",value:function(_){var e=this.getColumnsWidth(_);_.setColumnWidth(e),document.getElementsByClassName("luckysheet-scrollbar-x")[0].children[0].style.width=window.innerWidth.toString()+"px"}},{key:"buildLuckysheet",value:function(){var _=this;console.log(this.props);var e={},t=this.props.data,a=t[0].visibledatarow.length,n=t[0].visibledatacolumn.length;(e=this.props.editMode?{data:this.props.data,container:"luckysheet",enableAddRow:!1,enableAddBackTop:!1,showinfobar:!1,showstatisticBar:!1,showsheetbarConfig:{menu:!1},row:a,column:n}:{data:t,container:"luckysheet",enableAddRow:!1,enableAddBackTop:!1,showtoolbar:!1,showinfobar:!1,sheetFormulaBar:!1,showstatisticBar:!1,allowCopy:!1,showsheetbarConfig:{menu:!1},row:a,column:n,columnHeaderHeight:0,rowHeaderWidth:0}).hook={workbookCreateAfter:function(e){_.resizeColumnsToScreenWidth(o),_.props.editMode?o.showGridLines():o.hideGridLines()},updated:function(){console.log("updated"),_.props.saveData(o.getAllSheets())}};var o=window.luckysheet;o.create(e)}},{key:"componentDidUpdate",value:function(){console.log("componentDidUpdate"),this.buildLuckysheet()}},{key:"componentDidMount",value:function(){this.buildLuckysheet()}},{key:"render",value:function(){console.log("rendering");var _=this.props.editMode?"editMode":"liveMode";return n.a.createElement("div",{id:"luckysheet",className:_,style:{margin:"0px",padding:"0px",position:"absolute",width:"100%",bottom:"0px",left:"0px",top:"0px"}})}}]),t}(n.a.Component),E=t(119),p=[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0,visibledatarow:[[],[],[]],visibledatacolumn:[[],[],[]]}];var h=function(){var _=Object(a.useState)(u()),e=Object(c.a)(_,2),t=e[0],o=e[1],r=Object(a.useState)(!1),s=Object(c.a)(r,2),i=s[0],l=s[1];function u(){console.log("getData",p);var _=localStorage.getItem("luckysheet-data");if(_)try{return JSON.parse(_)}catch(e){console.error("Error parsing localStorage data",e)}return[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0,visibledatarow:[[],[],[]],visibledatacolumn:[[],[],[]]}]}function h(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==_&&(_=p);var t=JSON.stringify(_);localStorage.setItem("luckysheet-data",t),e&&o(u())}return n.a.createElement("div",{className:"App"},n.a.createElement(d,{data:t,editMode:i,saveData:h}),n.a.createElement(E.a,{editMode:i,setEditMode:function(_){o(u()),l(_)},saveData:h,getData:u}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(h,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(_){_.unregister()})).catch((function(_){console.error(_.message)}))}},[[124,1,2]]]);
//# sourceMappingURL=main.7c07689a.chunk.js.map